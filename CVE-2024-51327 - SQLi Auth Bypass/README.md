# CVE-2024-51327: SQL Injection in Travel Management System 1.0

Travel Management System version 1.0 by projectworlds has a SQL Injection vulnerability in `loginform.php` which leads to authentication bypass.
The POST parameters `t1` and `t2` is concatenated directly into SQL query leading to Authentication Bypass. 

Vulnerable code:
```php
<?php
$_SESSION['loginstatus']="";
if(isset($_POST["sbmt"]))
{
    $cn=makeconnection();
    $s="select * from users where Username='" . $_POST["t1"] . "' and Pwd='" . $_POST["t2"] ."'";

    $q=mysqli_query($cn,$s);
    $r=mysqli_num_rows($q);
$data=mysqli_fetch_array($q);
    mysqli_close($cn);
    if($r>0)
    {
        $_SESSION["Username"]= $_POST["t1"];
        $_SESSION["usertype"]=$data[2];
        $_SESSION['loginstatus']="yes";
        header("location:index.php");
    }
    else
    {
    echo "<script>alert('Invalid User Name or Password');</script>";
}
}
?> 
```
 
## Proof-of-concept:

* Intercept the login request to `loginform.php` using Burp Suite or any web proxy.
* set the username or `t1` parameter to - ` ' or 1=1 -- - `. (This pulls every row since it returns true everytime.)
* The authentication is bypassed and redirected to dashboard.



## Mitigation:
To fix this vulnerability, use parameterized queries or prepared statements instead of directly concatenating input parameters. This will prevent SQL injection attacks by treating the inputs as data, not as part of the SQL syntax.
<br><br>

**Discovered by Anirudh Krishnaprasad, October 2024.**

## References :

- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-51327](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-51327)
- https://nvd.nist.gov/vuln/detail/CVE-2024-51327
