# CVE-2024-51326: SQL Injection in Travel Management System 1.0

Travel Management System version 1.0 by projectworlds has Union-based SQL Injection vulnerability which leaks sensitive data from the Database.
The exploit works via the `t2` POST parameter in `deletesubcategory.php` component which insecurely concatenates HTTP Parameter into a MySQL query.


Vulnerable code:
```php
if(isset($_POST["show"]))
{

$cn=makeconnection();
$s="select * from subcategory where catid='" . $_POST["t2"] ."'";   // <-- POST param is Concatenated [!]
$result=mysqli_query($cn,$s);
$r=mysqli_num_rows($result);

while($data=mysqli_fetch_array($result))
{
        echo "<option value=$data[0]>$data[1]</option>"; <--- Output is reflected in response.
}
}
```

 
## Proof-of-concept:

* Intercept the request to `deletesubcategory.php` using Burp Suite or any web proxy.
* Use t2 parameter to inject a Union-based SQL query that retrieves data from the users table.
  example payload: `t2=1' UNION SELECT 1, version(), 3, 4, 5 -- -`
* The version information is reflected in the dropdown list.



## Mitigation:
To fix this vulnerability, use parameterized queries or prepared statements instead of directly concatenating input parameters. This will prevent SQL injection attacks by treating the inputs as data, not as part of the SQL syntax.

## Images:

![reflectedoutput](https://github.com/user-attachments/assets/99589cc8-1a05-4417-b129-90421d006443)

<br><br>

**Discovered by Anirudh Krishnaprasad, October 2024.**

## References :

- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-51326](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-51326)
- https://nvd.nist.gov/vuln/detail/CVE-2024-51326
